<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>排课规则 - NiceAdmin Bootstrap Template</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Vendor CSS Files -->
  <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="../assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="../assets/vendor/quill/quill.snow.css" rel="stylesheet">
  <link href="../assets/vendor/quill/quill.bubble.css" rel="stylesheet">
  <link href="../assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="../assets/vendor/simple-datatables/style.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="../assets/css/style.css" rel="stylesheet">

  <!-- 自定义样式 -->
<!--  <style>
    body {
  font-family: 'Segoe UI', system-ui;
  font-size: 13px;  /* 全局字体缩小 */
}

.table th, .table td {
  padding: 0.4rem;
}

.badge {
  font-weight: 400;
  padding: 0.25em 0.6em;
}

.card {
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}

.btn-sm {
  padding: 0.25rem 0.75rem;
  font-size: 0.8rem;
}
    .timetable-control-card {
  background: rgba(245, 249, 251, 0.9);
  border: 1px solid #dee2e6;
  border-radius: 0.5rem;
}

.progress {
  border-radius: 0.3rem;
  background-color: #e9ecef;
}

.table-sm td, .table-sm th {
  padding: 0.5rem;
}

.badge {
  font-weight: 500;
  padding: 0.4em 0.65em;
}


  </style>-->
  <style>
    .sidebar-nav .nav-link {
    display: flex;
    align-items: center;
    font-size: 15px;
    font-weight: 100;!important;
    }
    .sidebar-nav .nav-content a {
      display: flex;
      align-items: center;
      font-size: 14px;
      font-weight: 100;!important;
    }
    .progress-bar {
  background: linear-gradient(
    90deg,
    #f8dce3 0%,
    #f88a93 100%
  ) !important;
  color: #fff;
  transition: width 0.5s ease-in-out;
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
  font-size: 0.8rem;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* 颜色方案注释
   状态块背景色:
    总任务 #e3eff9 (浅蓝)
    已完成 #e3f6e9 (浅绿)
    未完成 #fbe9eb (浅红)
   按钮颜色:
    主要按钮 #89AFE0
    次要按钮 #bbd4f3
   徽章颜色梯度:
    理论课 #bbd4f3
    实践课 #89AFE0
    实验课 #6A8FBF
   进度条: #6A8FBF
*/

body {
  font-family: 'Segoe UI', system-ui;
  font-size: 13px;
}

.table th, .table td {
  padding: 0.4rem;
}

.badge {
  font-weight: 400;
  padding: 0.25em 0.6em;
  min-width: 60px;
  display: inline-block;
  text-align: center;
}

.card {
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  border: 1px solid #f0f0f0;
}

.btn-sm {
  padding: 0.25rem 0.75rem;
  font-size: 0.8rem;
  transition: all 0.2s;
}

.btn-sm:hover {
  filter: brightness(0.9);
}

#importFile {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  cursor: pointer;
}
</style>
</head>

<body>
<!-- ======= Header 顶部部分======= -->
  <header id="header" class="header fixed-top d-flex align-items-center">

    <div class="d-flex align-items-center justify-content-between">
      <a href="index.html" class="logo d-flex align-items-center">
        <img src="assets/img/logo.png" alt="">
        <span class="d-none d-lg-block">课境云枢排课系统</span>
      </a>
      <i class="bi bi-list toggle-sidebar-btn"></i>
    </div><!-- End Logo -->

    <div class="search-bar">
      <form class="search-form d-flex align-items-center" method="POST" action="#">
        <input type="text" name="query" placeholder="Search" title="Enter search keyword">
        <button type="submit" title="Search"><i class="bi bi-search"></i></button>
      </form>
    </div><!-- End Search Bar -->

    <nav class="header-nav ms-auto">
      <ul class="d-flex align-items-center">

        <li class="nav-item d-block d-lg-none">
          <a class="nav-link nav-icon search-bar-toggle " href="#">
            <i class="bi bi-search"></i>
          </a>
        </li><!-- End Search Icon-->

        <li class="nav-item dropdown">

          <a class="nav-link nav-icon" href="#" data-bs-toggle="dropdown">
            <i class="bi bi-bell"></i>
            <span class="badge bg-primary badge-number">4</span>
          </a><!-- End Notification Icon -->

          <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow notifications">
            <li class="dropdown-header">
              You have 4 new notifications
              <a href="#"><span class="badge rounded-pill bg-primary p-2 ms-2">View all</span></a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>

            <li class="notification-item">
              <i class="bi bi-exclamation-circle text-warning"></i>
              <div>
                <h4>Lorem Ipsum</h4>
                <p>Quae dolorem earum veritatis oditseno</p>
                <p>30 min. ago</p>
              </div>
            </li>

            <li>
              <hr class="dropdown-divider">
            </li>

            <li class="notification-item">
              <i class="bi bi-x-circle text-danger"></i>
              <div>
                <h4>Atque rerum nesciunt</h4>
                <p>Quae dolorem earum veritatis oditseno</p>
                <p>1 hr. ago</p>
              </div>
            </li>

            <li>
              <hr class="dropdown-divider">
            </li>

            <li class="notification-item">
              <i class="bi bi-check-circle text-success"></i>
              <div>
                <h4>Sit rerum fuga</h4>
                <p>Quae dolorem earum veritatis oditseno</p>
                <p>2 hrs. ago</p>
              </div>
            </li>

            <li>
              <hr class="dropdown-divider">
            </li>

            <li class="notification-item">
              <i class="bi bi-info-circle text-primary"></i>
              <div>
                <h4>Dicta reprehenderit</h4>
                <p>Quae dolorem earum veritatis oditseno</p>
                <p>4 hrs. ago</p>
              </div>
            </li>

            <li>
              <hr class="dropdown-divider">
            </li>
            <li class="dropdown-footer">
              <a href="#">Show all notifications</a>
            </li>

          </ul><!-- End Notification Dropdown Items -->

        </li><!-- End Notification Nav -->

        <li class="nav-item dropdown">

          <a class="nav-link nav-icon" href="#" data-bs-toggle="dropdown">
            <i class="bi bi-chat-left-text"></i>
            <span class="badge bg-success badge-number">3</span>
          </a><!-- End Messages Icon -->

          <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow messages">
            <li class="dropdown-header">
              You have 3 new messages
              <a href="#"><span class="badge rounded-pill bg-primary p-2 ms-2">View all</span></a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>

            <li class="message-item">
              <a href="#">
                <img src="assets/img/messages-1.jpg" alt="" class="rounded-circle">
                <div>
                  <h4>Maria Hudson</h4>
                  <p>Velit asperiores et ducimus soluta repudiandae labore officia est ut...</p>
                  <p>4 hrs. ago</p>
                </div>
              </a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>

            <li class="message-item">
              <a href="#">
                <img src="assets/img/messages-2.jpg" alt="" class="rounded-circle">
                <div>
                  <h4>Anna Nelson</h4>
                  <p>Velit asperiores et ducimus soluta repudiandae labore officia est ut...</p>
                  <p>6 hrs. ago</p>
                </div>
              </a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>

            <li class="message-item">
              <a href="#">
                <img src="assets/img/messages-3.jpg" alt="" class="rounded-circle">
                <div>
                  <h4>David Muldon</h4>
                  <p>Velit asperiores et ducimus soluta repudiandae labore officia est ut...</p>
                  <p>8 hrs. ago</p>
                </div>
              </a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>

            <li class="dropdown-footer">
              <a href="#">Show all messages</a>
            </li>

          </ul><!-- End Messages Dropdown Items -->

        </li><!-- End Messages Nav -->

        <li class="nav-item dropdown pe-3">

          <a class="nav-link nav-profile d-flex align-items-center pe-0" href="#" data-bs-toggle="dropdown">
            <img src="assets/img/profile-img.jpg" alt="Profile" class="rounded-circle">
            <span class="d-none d-md-block dropdown-toggle ps-2">K. Anderson</span>
          </a><!-- End Profile Iamge Icon -->

          <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile">
            <li class="dropdown-header">
              <h6>Kevin Anderson</h6>
              <span>Web Designer</span>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>

            <li>
              <a class="dropdown-item d-flex align-items-center" href="users-profile.html">
                <i class="bi bi-person"></i>
                <span>My Profile</span>
              </a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>

            <li>
              <a class="dropdown-item d-flex align-items-center" href="users-profile.html">
                <i class="bi bi-gear"></i>
                <span>Account Settings</span>
              </a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>

            <li>
              <a class="dropdown-item d-flex align-items-center" href="pages-faq.html">
                <i class="bi bi-question-circle"></i>
                <span>Need Help?</span>
              </a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>

            <li>
              <a class="dropdown-item d-flex align-items-center" href="#">
                <i class="bi bi-box-arrow-right"></i>
                <span>Sign Out</span>
              </a>
            </li>

          </ul><!-- End Profile Dropdown Items -->
        </li><!-- End Profile Nav -->

      </ul>
    </nav><!-- End Icons Navigation -->

  </header><!-- End Header -->

  <!-- ======= Sidebar侧边栏！！ ======= -->
  <aside id="sidebar" class="sidebar">

    <ul class="sidebar-nav" id="sidebar-nav">

      <li class="nav-item">
        <a class="nav-link collapsed" href="index.html">
          <i class="bi bi-grid"></i>
          <span>首页</span>
        </a>
      </li><!-- End Dashboard Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#components-nav" data-bs-toggle="collapse" href="#">
          <i class="bi bi-menu-button-wide"></i><span>基本数据</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="components-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="基本数据-教室数据-yes引入elelment改进版本又改进版--已确定！.html">
              <i class="bi bi-circle"></i><span>教室数据</span>
            </a>
          </li>
          <li>
            <a href="教师数据.html">
              <i class="bi bi-circle"></i><span>教师信息</span>
            </a>
          </li>
          <li>
            <a href="components-badges.html">
              <i class="bi bi-circle"></i><span>学生信息</span>
            </a>
          </li>
          <li>
            <a href="课程库.html">
              <i class="bi bi-circle"></i><span>课程库</span>
            </a>
          </li>
          <li>
            <a href="专业数据.html">
              <i class="bi bi-circle"></i><span>专业数据</span>
            </a>
          </li>
          <li>
            <a href="班级数据.html">
              <i class="bi bi-circle"></i><span>班级数据</span>
            </a>
          </li>
          <li>
            <a href="教学楼数据.html">
              <i class="bi bi-circle"></i><span>教学楼信息</span>
            </a>
          </li>
          <li>
            <a href="部门数据.html">
              <i class="bi bi-circle"></i><span>部门数据</span>
            </a>
          </li>
          <li>
            <a href="专业数据.html">
              <i class="bi bi-circle"></i><span>专业方向</span>
            </a>
          </li>
          <!--<li>
            <a href="components-tabs.html">
              <i class="bi bi-circle"></i><span>Tabs</span>
            </a>
          </li>
          <li>
            <a href="components-pagination.html">
              <i class="bi bi-circle"></i><span>Pagination</span>
            </a>
          </li>
          <li>
            <a href="components-progress.html">
              <i class="bi bi-circle"></i><span>Progress</span>
            </a>
          </li>
          <li>
            <a href="components-spinners.html">
              <i class="bi bi-circle"></i><span>Spinners</span>
            </a>
          </li>-->
         <!-- <li>
            <a href="components-tooltips.html">
              <i class="bi bi-circle"></i><span>Tooltips</span>
            </a>
          </li>-->
        </ul>
      </li><!-- End Components Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#forms-nav" data-bs-toggle="collapse" href="#">
          <i class="bi bi-journal-text"></i><span>智能排课</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="forms-nav" class="nav-content collapse show" data-bs-parent="#sidebar-nav">
         <li>
            <a href="智能排课.html">
              <i class="bi bi-circle"></i><span>智能排课</span>
            </a>
          </li>
          <li>
            <a href="forms-layouts.html">
              <i class="bi bi-circle"></i><span>数据检测</span>
            </a>
          </li>
        </ul>
      </li><!-- End Forms Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#tables-nav" data-bs-toggle="collapse" href="#">
          <i class="bi bi-layout-text-window-reverse"></i><span>组织管理</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="tables-nav" class="nav-content collapse" data-bs-parent="#sidebar-nav">
          <li>
            <a href="偏好设置3.html">
              <i class="bi bi-circle"></i><span>偏好设置</span>
            </a>
          </li>
          <li>
            <a href="整个页面！！！！！！！组织管理 请假审批--已确定！.html" >
              <i class="bi bi-circle"></i><span>请假审批</span>
            </a>
          </li>
        </ul>
      </li><!-- End Tables Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#charts-nav" data-bs-toggle="collapse" href="#">
          <i class="bi bi-bar-chart"></i><span>排课表查询</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="charts-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="班级课表.html">
              <i class="bi bi-circle"></i><span>班级课表查询</span>
            </a>
          </li>
          <li>
            <a href="charts-apexcharts.html">
              <i class="bi bi-circle"></i><span>学生课表查询</span>
            </a>
          </li>
          <li>
            <a href="charts-echarts.html">
              <i class="bi bi-circle"></i><span>教师课表查询</span>
            </a>
          </li>
          <li>
            <a href="嵌入了elementuizz的页面-课程添加已确定！.html">
              <i class="bi bi-circle"></i><span>添加课程</span>
            </a>
          </li>
        </ul>
      </li><!-- End Charts Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#icons-nav" data-bs-toggle="collapse" href="#">
          <i class="bi bi-gem"></i><span>排课规则</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="icons-nav" class="nav-content collapse show " data-bs-parent="#sidebar-nav">
          <li>
            <a href="排课规则-排课方案设置-yes大幅度修改了一下的--已确定.html">
              <i class="bi bi-circle"></i><span>排课方案设置</span>
            </a>
          </li>
          <li>
            <a href="禁排omgomgomg.html">
              <i class="bi bi-circle"></i><span>禁排设置</span>
            </a>
          </li>
        </ul>
      </li><!-- End Icons Nav -->

      <li class="nav-heading">Pages</li>

      <li class="nav-item">
        <a class="nav-link collapsed" href="users-profile.html">
          <i class="bi bi-person"></i>
          <span>统计信息</span>
        </a>
      </li><!-- End Profile Page Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" href="pages-faq.html">
          <i class="bi bi-question-circle"></i>
          <span>更多帮助</span>
        </a>
      </li><!-- End F.A.Q Page Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" href="pages-contact.html">
          <i class="bi bi-envelope"></i>
          <span>联系我们</span>
        </a>
      </li><!-- End Contact Page Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" href="pages-register.html">
          <i class="bi bi-card-list"></i>
          <span>后台管理</span>
        </a>
      </li><!-- End Register Page Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" href="pages-login.html">
          <i class="bi bi-box-arrow-in-right"></i>
          <span>登录问题</span>
        </a>
      </li><!-- End Login Page Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" href="pages-error-404.html">
          <i class="bi bi-dash-circle"></i>
          <span>Error 404</span>
        </a>
      </li><!-- End Error 404 Page Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" href="pages-blank.html">
          <i class="bi bi-file-earmark"></i>
          <span>Blank</span>
        </a>
      </li><!-- End Blank Page Nav -->

    </ul>

  </aside><!-- End Sidebar-->

<main id="main" class="main">
  <div class="pagetitle">
    <h2 style="color: #3a5985">智能排课</h2>
    <nav>
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="index.html">首页</a></li>
        <li class="breadcrumb-item">智能排课</li>
        <li class="breadcrumb-item active" style="color: #3a5985">智能排课</li>
      </ol>
    </nav>
  </div><!-- End Page Title -->

  <!-- 排课控制区 -->
  <div class="row mb-3">
    <div class="col-12">
      <div class="card timetable-control-card" style="border-radius: 8px">
        <div class="card-body py-2">
          <div class="row g-2 align-items-center">
            <div class="col-auto">
              <button class="btn btn-sm" id="btnStartAutoSchedule"
                      style="background: #0d6efd; color: white">
                <i class="bi bi-magic me-1"></i>开始排课
              </button>
            </div>
            <div class="col-auto">
      <div class="btn-group" role="group">
        <button type="button" class="btn btn-sm btn-outline-primary active"
                data-mode="all" onclick="setScheduleMode('all')">全部课程</button>
        <button type="button" class="btn btn-sm btn-outline-primary"
                data-mode="selected" onclick="setScheduleMode('selected')">选中课程</button>
      </div>
    </div>
            <div class="col-auto">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="chkClearExisting">
                <label class="form-check-label" style="font-size: 0.85rem">
                  清除已有排课
                </label>
              </div>
            </div>

            <div class="col-auto">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="chkAutoAssignLocation" checked>
                <label class="form-check-label" style="font-size: 0.85rem">
                  自动分配教室
                </label>
              </div>
            </div>

            <div class="col-auto ms-auto">
              <label class="btn btn-sm" style="background: #0d6efd; color: white; position: relative">
                <i class="bi bi-upload me-1"></i>导入排课
                <input type="file" id="importFile" hidden accept=".xlsx,.csv"
                       onchange="handleFileSelect(event)">
              </label>
              <button class="btn btn-sm" id="btnExportResults"
                      style="background:#0d6efd; color: white">
                <i class="bi bi-download me-1"></i>导出结果
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 课程选择与排课监控区 -->
  <div class="row">
    <!-- 课程选择列 -->
    <div class="col-md-4">
      <div class="card h-100" style="border-radius: 8px">
        <div class="card-header bg-light py-2" style="font-size: 0.9rem">
          <i class="bi bi-list-check me-1"></i>待排课程列表（共1365项）
        </div>
        <div class="card-body p-2">
          <div class="table-responsive">
            <table class="table table-hover table-sm" style="font-size: 0.8rem">
              <thead class="bg-light">
                <tr>
                  <th><input type="checkbox" id="checkAll"></th>
                  <th>课程名称</th>
                  <th>学时</th>
                  <th>班级</th>
                  <th>类型</th>
                </tr>
              </thead>
              <tbody id="courseList">
                <tr>
                  <td><input type="checkbox" class="course-check" data-id="1"></td>
                  <td>学前儿童社会教育</td>
                  <td>18</td>
                  <td>23学前5班</td>
                  <td><span class="badge" style="background: #bbd4f3">理论课</span></td>
                </tr>
                <tr>
                  <td><input type="checkbox" class="course-check" data-id="2"></td>
                  <td>汽车机械基础</td>
                  <td>72</td>
                  <td>24汽修1/2班</td>
                  <td><span class="badge" style="background:#fbeeb6">实践课</span></td>
                </tr>
                <tr>
                  <td><input type="checkbox" class="course-check" data-id="3"></td>
                  <td>石油化工工艺学</td>
                  <td>108</td>
                  <td>22化工智造1班</td>
                  <td><span class="badge" style="background: #fbd6dd">实验课</span></td>
                </tr>
                <tr>
                  <td><input type="checkbox" class="course-check" data-id="4"></td>
                  <td>3dsMAX动画制作</td>
                  <td>72</td>
                  <td>22数媒1班</td>
                  <td><span class="badge" style="background: #bbd4f3">理论课</span></td>
                </tr>
                <tr>
                  <td><input type="checkbox" class="course-check" data-id="5"></td>
                  <td>数控加工工艺</td>
                  <td>144</td>
                  <td>23机械1班</td>
                  <td><span class="badge" style="background: #fbeeb6">实践课</span></td>
                </tr>
              </tbody>
              <div class="card-footer bg-light py-2">
  <div class="d-flex justify-content-between align-items-center">
    <small class="text-muted">已选择 <span id="selectedCount">0</span> 门课程</small>
    <button class="btn btn-sm btn-primary" onclick="scheduleSelected()">
      <i class="bi bi-play-circle me-1"></i>排选中课程
    </button>
  </div>
</div>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- 排课监控列 -->
    <div class="col-md-8">
      <div class="card h-100" style="border-radius: 8px">
        <div class="card-header bg-light py-2" style="font-size: 0.9rem">
          <i class="bi bi-speedometer2 me-1"></i>排课进度监控
        </div>
        <div class="card-body p-3">
          <!-- 进度统计 -->
          <div class="row mb-3 g-2">
            <div class="col-4">
              <div class="p-2 rounded" style="background: #e9f1f8; font-size: 0.8rem">
                <div>总任务数</div>
                <div class="h5 mb-0" id="totalTasks">1365</div>
              </div>
            </div>
            <div class="col-4">
              <div class="p-2 rounded" style="background: #e3f6e6; font-size: 0.8rem">
                <div>已完成</div>
                <div class="h5 mb-0" id="completedTasks">1288</div>
              </div>
            </div>
            <div class="col-4">
              <div class="p-2 rounded" style="background: #fbe9eb; font-size: 0.8rem">
                <div>未完成</div>
                <div class="h5 mb-0" id="pendingTasks">77</div>
              </div>
            </div>
          </div>

          <!-- 进度条 -->
          <div class="progress mb-3" style="height: 20px; border-radius: 10px">
  <div class="progress-bar progress-bar-striped"
       role="progressbar"
       style="width: 94.3%;
              background-image: linear-gradient(
                90deg,
                #ff9a9e 0%,    <!-- 起始颜色 -->
                #fad6e1 100%   <!-- 结束颜色 -->
              );
              background-size: 40px 100%;
              border-radius: 10px;"
       id="progressBar">
    94.3%
  </div>
</div>

          <!-- 未排课程报告 -->
          <div class="border-top pt-2">
            <h6 class="text-danger mb-2" style="font-size: 0.85rem">
              <i class="bi bi-exclamation-triangle me-1"></i>排课冲突报告（最近10条）
            </h6>
            <div class="table-responsive">
              <table class="table table-sm" style="font-size: 0.8rem">
                <thead>
                  <tr>
                    <th>课程名称</th>
                    <th>班级</th>
                    <th>冲突原因</th>
                  </tr>
                </thead>
                <tbody id="unScheduledList">
                  <tr>
                    <td>汽车电控发动机维修</td>
                    <td>21汽修1班</td>
                    <td><span class="badge bg-danger">时间冲突</span></td>
                  </tr>
                  <tr>
                    <td>学前教育学</td>
                    <td>24学前4班</td>
                    <td><span class="badge bg-danger">教室不足</span></td>
                  </tr>
                  <tr>
                    <td>机械制造基础</td>
                    <td>24机械1/2班</td>
                    <td><span class="badge bg-danger">教师冲突</span></td>
                  </tr>
                  <tr>
                    <td>网络直播营销</td>
                    <td>22直播2班</td>
                    <td><span class="badge bg-danger">设备不足</span></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<!--<script>
document.addEventListener('DOMContentLoaded', function() {
  const totalTasks = 1365; // 总任务数
  let scheduleState = {
    completed: 0,
    unScheduled: []
  };

  // 全选功能
  document.getElementById('checkAll').addEventListener('change', function(e) {
    document.querySelectorAll('.course-check').forEach(checkbox => {
      checkbox.checked = e.target.checked;
    });
  });

  // 开始排课
  document.getElementById('btnStartAutoSchedule').addEventListener('click', function() {
    scheduleState = { completed: 0, unScheduled: [] };
    updateProgressUI();
    simulateScheduleProcess();
  });

  // 模拟排课进度
  function simulateScheduleProcess() {
    const interval = setInterval(() => {
      if(scheduleState.completed < totalTasks) {
        scheduleState.completed++;
        // 模拟5%的排课冲突
        if(Math.random() < 0.05) {
          scheduleState.unScheduled.push({
            course: `课程${scheduleState.completed}`,
            class: "示例班级",
            reason: ['时间冲突','教室不足','教师冲突'][Math.floor(Math.random()*3)]
          });
        }
        updateProgressUI();
      } else {
        clearInterval(interval);
      }
    }, 10); // 加快模拟速度
  }

  // 更新界面
  function updateProgressUI() {
    // 更新进度数字
    document.getElementById('completedTasks').textContent = scheduleState.completed;
    document.getElementById('pendingTasks').textContent = totalTasks - scheduleState.completed;

    // 更新进度条
    const progress = (scheduleState.completed / totalTasks) * 100;
    const progressBar = document.getElementById('progressBar');
    progressBar.style.width = `${progress}%`;
    progressBar.textContent = `${progress.toFixed(1)}%`;

    // 更新未排课程列表
    const tbody = document.getElementById('unScheduledList');
    tbody.innerHTML = scheduleState.unScheduled.slice(-10).map(item => `
      <tr>
        <td>${item.course}</td>
        <td>${item.class}</td>
        <td><span class="badge bg-danger">${item.reason}</span></td>
      </tr>
    `).join('');
  }

  // 导出功能
  document.getElementById('btnExportResults').addEventListener('click', function() {
    const data = {
      total: totalTasks,
      completed: scheduleState.completed,
      unScheduled: scheduleState.unScheduled
    };
    const blob = new Blob([JSON.stringify(data)], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `排课报告_${new Date().toLocaleDateString()}.json`;
    a.click();
    URL.revokeObjectURL(url);
  });
});
</script>-->
<script>
function handleFileSelect(event) {
  const file = event.target.files[0];
  if (file) {
    alert(`已选择文件: ${file.name}\n（此处可添加实际导入逻辑）`);
  }
}

document.addEventListener('DOMContentLoaded', function() {
  const totalTasks = 1365;
  let scheduleState = {
    completed: 1288,
    unScheduled: [
      { course: "汽车电控发动机维修", class: "21汽修1班", reason: "时间冲突" },
      { course: "学前教育学", class: "24学前4班", reason: "教室不足" },
      { course: "机械制造基础", class: "24机械1/2班", reason: "教师冲突" },
      { course: "网络直播营销", class: "22直播2班", reason: "设备不足" }
    ]
  };

  // 全选功能
  document.getElementById('checkAll').addEventListener('change', function(e) {
    document.querySelectorAll('.course-check').forEach(checkbox => {
      checkbox.checked = e.target.checked;
    });
  });

  // 开始排课
  document.getElementById('btnStartAutoSchedule').addEventListener('click', function() {
    scheduleState = { completed: 0, unScheduled: [] };
    updateProgressUI();
    simulateScheduleProcess();
  });

  // 模拟排课进度
  function simulateScheduleProcess() {
    const interval = setInterval(() => {
      if(scheduleState.completed < totalTasks) {
        scheduleState.completed++;
        if(Math.random() < 0.05) {
          scheduleState.unScheduled.push({
            course: `课程${scheduleState.completed}`,
            class: "示例班级",
            reason: ['时间冲突','教室不足','教师冲突','设备不足'][Math.floor(Math.random()*4)]
          });
        }
        updateProgressUI();
        if(scheduleState.completed === totalTasks) clearInterval(interval);
      }
    }, 10);
  }

  // 更新界面
  function updateProgressUI() {
    document.getElementById('completedTasks').textContent = scheduleState.completed;
    document.getElementById('pendingTasks').textContent = totalTasks - scheduleState.completed;

    const progress = (scheduleState.completed / totalTasks) * 100;
    const progressBar = document.getElementById('progressBar');
    progressBar.style.width = `${progress}%`;
    progressBar.textContent = `${progress.toFixed(1)}%`;

    const tbody = document.getElementById('unScheduledList');
    tbody.innerHTML = scheduleState.unScheduled.slice(-10).map(item => `
      <tr>
        <td>${item.course}</td>
        <td>${item.class}</td>
        <td><span class="badge bg-danger">${item.reason}</span></td>
      </tr>
    `).join('');
  }

  // 导出功能
  document.getElementById('btnExportResults').addEventListener('click', function() {
    const data = {
      total: totalTasks,
      completed: scheduleState.completed,
      unScheduled: scheduleState.unScheduled
    };
    const blob = new Blob([JSON.stringify(data)], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `排课报告_${new Date().toLocaleDateString()}.json`;
    a.click();
    URL.revokeObjectURL(url);
  });
});
// 新增排课模式状态
let scheduleMode = 'all'; // all/selected
let selectedCourses = new Set();

// 模式切换函数
function setScheduleMode(mode) {
  scheduleMode = mode;
  document.querySelectorAll('[data-mode]').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.mode === mode);
  });
  document.getElementById('checkAll').disabled = mode === 'selected';
}

// 选中课程统计
document.querySelectorAll('.course-check').forEach(checkbox => {
  checkbox.addEventListener('change', () => {
    const id = checkbox.dataset.id;
    checkbox.checked ? selectedCourses.add(id) : selectedCourses.delete(id);
    document.getElementById('selectedCount').textContent = selectedCourses.size;
  });
});

// 全选功能改造
document.getElementById('checkAll').addEventListener('change', function(e) {
  const checkboxes = document.querySelectorAll('.course-check');
  checkboxes.forEach(checkbox => {
    checkbox.checked = e.target.checked;
    const id = checkbox.dataset.id;
    e.target.checked ? selectedCourses.add(id) : selectedCourses.delete(id);
  });
  document.getElementById('selectedCount').textContent = selectedCourses.size;
});

// 新增排课执行函数
function scheduleSelected() {
  const clearExisting = document.getElementById('chkClearExisting').checked;
  const autoAssign = document.getElementById('chkAutoAssignLocation').checked;

  const targetCourses = scheduleMode === 'all'
    ? Array.from(document.querySelectorAll('.course-check')).map(c => c.dataset.id)
    : Array.from(selectedCourses);

  if(targetCourses.length === 0) {
    alert('请选择要排课的课程');
    return;
  }

  if(clearExisting) {
    if(!confirm('确定要清除已有排课信息吗？')) return;
  }

  startScheduleProcess(targetCourses, {
    clearExisting,
    autoAssign
  });
}

// 改造后的排课模拟逻辑
function startScheduleProcess(courses, options) {
  const total = courses.length;
  scheduleState = { completed: 0, unScheduled: [], total };

  document.getElementById('totalTasks').textContent = total;
  updateProgressUI();

  const interval = setInterval(() => {
    if(scheduleState.completed < total) {
      scheduleState.completed++;
      if(Math.random() < 0.05) {
        scheduleState.unScheduled.push({
          course: `课程${courses[scheduleState.completed-1]}`,
          reason: ['时间冲突','教室不足','教师冲突','设备不足'][Math.floor(Math.random()*4)]
        });
      }
      updateProgressUI();
    } else {
      clearInterval(interval);
    }
  }, 10);
}

</script>
  <!-- Vendor JS Files -->
  <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <!-- Template Main JS File -->
  <script src="../assets/js/main.js"></script>
</body>

</html>